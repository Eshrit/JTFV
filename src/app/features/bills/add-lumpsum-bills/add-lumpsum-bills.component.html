<app-navbar class="no-print"></app-navbar>

<div class="container">
  <!-- Shop Header -->
  <div class="top-section text-center">
    <h2 class="title">J.T. Fruits & Vegetables</h2>
    <div class="address-line">
      Shop No. 31-32, Bldg No. 27, EMP Op Jogers Park, Thakur Village, Kandivali(E), Mumbai 400101
    </div>
    <div class="license-line">
      PAN: AAJFJ0258J | FSS LICENSE ACT 2006 LICENSE NO: 11517011000128
    </div>
    <div class="email-line">Email: jkumarshahu5&#64;gmail.com</div>
  </div>

  <!-- TAX FREE INVOICE centered -->
  <h3 class="invoice-title">TAX FREE INVOICE</h3>

  <!-- Two-column row: LEFT(Name/Address) | RIGHT(Bill No/Date/Amount) -->
  <div class="info-grid">
    <!-- LEFT -->
    <div class="left-info">
      <div class="line">
        <label>Name :</label>
        <span class="print-toggle">
          <select class="form-control client-select no-print" [(ngModel)]="selectedClient" (change)="onClientChange()" tabindex="1" >
            <option [ngValue]="null">Select Client</option>
            <option *ngFor="let client of clients" [ngValue]="client">
              {{ client.firstName }}
            </option>
          </select>
          <span class="print-view">{{ clientName }}</span>
        </span>
      </div>

      <div class="line">
        <label>Address :</label>
        <span class="print-toggle">
          <textarea class="form-control address-area no-print" [(ngModel)]="address" (input)="autoResize($event)" #addressBox tabindex="-1" ></textarea>
          <span class="print-view" style="white-space: pre-line;">{{ address }}</span>
        </span>
      </div>

      <!-- NEW: Fixed GST number (no input) -->
      <div class="line">
        <label>GST No :</label>
        <span>27AACCA8432HIZQ</span>
      </div>
    </div>

    <!-- RIGHT -->
    <div class="right-meta">
      <div class="meta">
        <label>Bill No :</label>
        <span class="print-toggle">
          <input type="text" class="form-control bill-control no-print" [(ngModel)]="billNumber" readonly tabindex="-1" />
          <span class="print-view">{{ billNumber }}</span>
        </span>
      </div>

      <div class="meta">
        <label>Date :</label>
        <span class="print-toggle">
          <input type="date" class="form-control no-print" [(ngModel)]="billDate" tabindex="-1" />
          <span class="print-view">{{ billDate | date:'dd/MM/yyyy' }}</span>
        </span>
      </div>

      <div class="meta">
        <label>Amount :</label>
        <span class="print-toggle">
          <input type="number" class="form-control no-print" [(ngModel)]="amount" (input)="calculateFinalAmount()" tabindex="2" />
          <span class="print-view">{{ amount | number:'1.2-2' }}</span>
        </span>
      </div>
    </div>
  </div>

  <!-- Description (unchanged) -->
  <div class="print-toggle print-value description-container">
    <textarea [(ngModel)]="description" class="form-control no-print" rows="6" style="width: 100%; margin-bottom: 20px;" tabindex="3"
    ></textarea>
    <div class="description-print print-view">{{ description }}</div>
  </div>

  <!-- Summary -->
  <div class="print-summary-footer">
    <div class="summary">
      <label>Total Amount :</label>
      <div>{{ amount | number:'1.2-2' }}</div>
    </div>

    <div class="summary print-toggle">
      <label>Discount :</label>
      <div class="discount-line">
        <input class="form-control no-print" type="number" [(ngModel)]="discount" (input)="calculateFinalAmount()" style="width: 70px" tabindex="4" /> 
        <span class="no-print">%</span>
        <span class="print-view">{{ discount }} %</span>
        <span class="margin-value">{{ marginValue | number:'1.2-2' }}</span>
      </div>
    </div>

    <div class="summary">
      <label>Grand Total :</label>
      <div>{{ finalAmount | number:'1.2-2' }}</div>
    </div>
  </div>

  <!-- Actions (unchanged) -->
  <div class="actions no-print">
    <button class="btn btn-success" (click)="saveBill()">Save</button>
    <button class="btn btn-primary" (click)="printBill()">Print</button>
    <input type="email" [(ngModel)]="manualEmail" class="form-control" placeholder="Enter email"
      style="width: 250px; display: inline-block; margin-right: 10px;"
    />
    <button class="btn btn-secondary" (click)="emailBill()">Email</button>
  </div>
</div>